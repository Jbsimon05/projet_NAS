enable
version 15.2
service timestamps debug datetime msec
service timestamps log datetime msec
hostname PE3
boot-start-marker
boot-end-marker
no aaa new-model
no ip icmp rate-limit unreachable
ip cef
!
ip vrf Red
 rd 65000:65001
 route-target export 65000:65001
 route-target import 65000:65001
!
ip vrf Green
 rd 65000:65002
 route-target export 65000:65002
 route-target import 65000:65002
!
ip vrf Blue
 rd 65000:65003
 route-target export 65000:65003
 route-target import 65000:65003
!
no ip domain lookup
mpls label protocol ldp
no ipv6 cef
multilink bundle-name authenticated
ip tcp synwait-time 5!
interface loopback0
 ip address 192.168.100.7 255.255.255.255
!
 interface FastEthernet0/0
 ip address 192.168.1.38 255.255.255.252
 duplex full
 negociate auto
 mpls ip
 ip vrf forwarding Red
!
 interface GigabitEthernet1/0
 ip address 192.168.1.53 255.255.255.252
 negociate auto
 ip vrf forwarding Green
!
 interface GigabitEthernet2/0
 ip address 192.168.1.57 255.255.255.252
 negociate auto
 ip vrf forwarding Blue
!
 interface GigabitEthernet3/0
 ip address 192.168.1.61 255.255.255.252
 negociate auto
router ospf 1
 network 192.168.100.7 0.0.0.0 area 0
 network 192.168.1.53 0.0.0.3 area 0
 network 192.168.1.57 0.0.0.3 area 0
 network 192.168.1.61 0.0.0.3 area 0
 maximum-paths 3
router bgp 65000
 bgp router-id 192.168.100.7/32
 bgp log-neighbor-changes
 neighbor 192.168.100.1/32 remote-as 65000
 neighbor 192.168.100.1/32 update-source Loopback0
 neighbor 192.168.100.2/32 remote-as 65000
 neighbor 192.168.100.2/32 update-source Loopback0
 neighbor 192.168.100.3/32 remote-as 65000
 neighbor 192.168.100.3/32 update-source Loopback0
 neighbor 192.168.100.4/32 remote-as 65000
 neighbor 192.168.100.4/32 update-source Loopback0
 neighbor 192.168.100.5/32 remote-as 65000
 neighbor 192.168.100.5/32 update-source Loopback0
 neighbor 192.168.100.6/32 remote-as 65000
 neighbor 192.168.100.6/32 update-source Loopback0
 !
 address-family ipv4
  neighbor 192.168.100.1/32 activate
  neighbor 192.168.100.1/32 send-community both
  neighbor 192.168.100.2/32 activate
  neighbor 192.168.100.2/32 send-community both
  neighbor 192.168.100.3/32 activate
  neighbor 192.168.100.3/32 send-community both
  neighbor 192.168.100.4/32 activate
  neighbor 192.168.100.4/32 send-community both
  neighbor 192.168.100.5/32 activate
  neighbor 192.168.100.5/32 send-community both
  neighbor 192.168.100.6/32 activate
  neighbor 192.168.100.6/32 send-community both
 exit-address-family
 !
 address-family vpnv4
  neighbor 192.168.100.1/32 activate
  neighbor 192.168.100.1/32 send-community both
  neighbor 192.168.100.2/32 activate
  neighbor 192.168.100.2/32 send-community both
  neighbor 192.168.100.3/32 activate
  neighbor 192.168.100.3/32 send-community both
  neighbor 192.168.100.4/32 activate
  neighbor 192.168.100.4/32 send-community both
  neighbor 192.168.100.5/32 activate
  neighbor 192.168.100.5/32 send-community both
  neighbor 192.168.100.6/32 activate
  neighbor 192.168.100.6/32 send-community both
 exit-address-family
 !
 address-family ipv4 vrf Red
  neighbor 192.168.100.10/32 remote-as 65001
  neighbor 192.168.100.10/32 activate
  neighbor 192.168.100.10/32 send-community both
 exit address-family
 address-family ipv4 vrf Green
  neighbor 192.168.100.16/32 remote-as 65002
  neighbor 192.168.100.16/32 activate
  neighbor 192.168.100.16/32 send-community both
 exit address-family
 address-family ipv4 vrf Blue
  neighbor 192.168.100.22/32 remote-as 65003
  neighbor 192.168.100.22/32 activate
  neighbor 192.168.100.22/32 send-community both
 exit address-family
ip forward-protocol nd
no ip http server
no ip http secure-server
control-plane
line con 0
 exec-timeout 0 0
!
 privilege level 15
 logging synchronous
 stopbits 1
line aux 0
 exec-timeout 0 0
 privilege level 15
 logging synchronous
 stopbits 1
line vty 0 4
 login
end
!
